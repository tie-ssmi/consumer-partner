<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title data-i18n="title_home">Homepage</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="index_user/style.css">
    
    <script src="index_user/js/languages.js"></script>
    
    <style>
        /* Animation เลื่อนซ้ายวนลูป */
        @keyframes scroll-left {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        .infinite-scroll-track {
            display: flex;
            gap: 0.75rem; 
            width: max-content;
            animation: scroll-left 30s linear infinite;
        }
        /* แตะแล้วหยุดเลื่อน */
        .infinite-scroll-track:active { animation-play-state: paused; }
    </style>
</head>
<body class="flex justify-center h-screen w-screen overflow-hidden text-gray-800 bg-gray-100">
    
    <div class="w-full max-w-xl bg-white shadow-2xl relative flex flex-col h-full">
        
        <header class="bg-[#DC2626] text-white h-14 flex items-center justify-between px-4 shadow-md shrink-0 z-50">
            <div class="w-8"></div> 
            <div class="font-bold text-lg" data-i18n="nav_home">homepage</div>
            <div class="flex items-center gap-2">
                

                <button onclick="toggleNewsModal()" class="hover:bg-white/20 p-2 rounded-full transition">
                    <i class="fa-solid fa-circle-info text-xl"></i>
                </button>
                <button onclick="toggleFloatingNotif()" class="hover:bg-white/20 p-2 rounded-full relative transition">
                    <i class="fa-regular fa-bell text-xl"></i>
                    <div class="notif-dot-badge absolute top-2 right-2 w-2 h-2 bg-yellow-400 rounded-full hidden"></div>
                </button>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-4 space-y-5 pb-4 scroll-smooth bg-gray-50">
            
            <div>
                <h2 class="text-gray-800 font-bold text-lg" data-i18n="daily_tasks">Daily Tasks</h2>
                <p class="text-gray-400 text-xs mb-3" data-i18n="urgent_tasks">Higher Commission for Urgent Tasks</p>
                
                <div class="w-full overflow-hidden"> 
                    <div id="scrolling-products" class="infinite-scroll-track">
                        <div class="p-4 text-xs text-gray-400 w-full text-center bg-gray-50 rounded-lg" data-i18n="loading_products">กำลังโหลดสินค้า...</div>
                    </div>
                </div>

                <button id="start-work-btn" onclick="startGrabbing()" class="w-full bg-[#DC2626] text-white py-3.5 rounded-full font-bold text-base shadow-lg hover:bg-[#b91c1c] active:scale-95 transition mt-4" data-i18n="start_work">
                    start grabbing orders
                </button>
            </div>

            <div class="bg-gradient-to-r from-[#FF512F] to-[#F09819] rounded-xl p-4 text-white shadow-md relative overflow-hidden">
                <div class="relative z-10">
                    <h3 class="font-bold text-sm mb-1" data-i18n="mem_benefits">Membership Benefits</h3>
                    <p class="text-[10px] font-medium mb-3 leading-tight opacity-90" data-i18n="mem_desc">HIGHER MEMBERSHIP LEVELS, TAKING<br>ON MORE TASKS TO ENJOY MORE EARNINGS.</p>
                    
                    <button onclick="window.location.href='index_user/service.html'" class="bg-white text-[#FF512F] text-[10px] font-bold px-3 py-1.5 rounded-full shadow-sm" data-i18n="upgrade_now">Upgrade Now</button>
                </div>
                <div class="absolute -right-4 -bottom-8 w-24 h-24 bg-white/20 rounded-full blur-xl"></div>
            </div>

            <div>
                <h2 class="text-gray-800 font-bold text-lg" data-i18n="partners">Partner Brands</h2>
                <p class="text-gray-400 text-xs mb-3" data-i18n="partners_desc">Brand Partners</p>
                <div class="grid grid-cols-3 gap-2">
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Lazada_%282019%29.svg/1024px-Lazada_%282019%29.svg.png" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://logonoid.com/images/marks-and-spencer-logo.png" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/EBay_logo.svg/2560px-EBay_logo.svg.png" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://mms.businesswire.com/media/20210322005442/en/866099/5/HB_Stripes_EN_%284%29_highres.jpg?download=1" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://brandlogos.net/wp-content/uploads/2021/10/Alibaba.com-logo-1.png" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8b/Brookfield_Asset_Management_logo.svg/1280px-Brookfield_Asset_Management_logo.svg.png" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Walmart_logo_%282008%29.svg" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Rakuten_Global_Brand_Logo.svg/960px-Rakuten_Global_Brand_Logo.svg.png" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://www.dreamplaza.com.pa/wp-content/uploads/2025/03/logo-Dream-extragrande.png" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://new-backoffice.tarad.com/assets/images/logo_tarad.png" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Amazon_logo.svg/2560px-Amazon_logo.svg.png" class="h-full w-full object-contain"></div>
                    <div class="bg-white border border-gray-100 rounded-lg h-12 flex items-center justify-center shadow-sm p-2"><img src="https://www.red-dot.org/fileadmin/_processed_/5/f/csm_07-DP06104-2023BC_Lotte_Mart_ffbaaf7343.png" class="h-full w-full object-contain"></div>
                </div>
            </div>
            
            <div>
                <h2 class="text-gray-800 font-bold text-lg" data-i18n="service_center">Service Center</h2>
                <p class="text-gray-400 text-xs mb-3" data-i18n="service_desc">For further inquiries, please contact our Customer Service Center</p>
                
                <div class="space-y-2">
                    <button onclick="showInviteModal()" class="w-full bg-white border border-gray-100 rounded-lg h-12 px-4 flex justify-between items-center shadow-sm active:bg-gray-50 transition">
                        <span class="text-gray-700 text-sm" data-i18n="invite">invite friends</span>
                        <i class="fa-solid fa-chevron-right text-gray-400 text-xs"></i>
                    </button>

                    <button onclick="toggleAboutUs()" class="w-full bg-white border border-gray-100 rounded-lg h-12 px-4 flex justify-between items-center shadow-sm active:bg-gray-50 transition">
                        <span class="text-gray-700 text-sm uppercase" data-i18n="comp_qual">COMPANY QUALIFICATION</span>
                        <i class="fa-solid fa-chevron-right text-gray-400 text-xs"></i>
                    </button>
                </div>
            </div>

            <div class="h-6"></div>
        </div>

        <div id="bottom-nav" class="shrink-0 z-50 relative"></div>
        <div id="modal-container"></div> 
    </div>

    <script src="index_user/app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="index_user/firebase_config.js"></script>
    
    <script>
        function fetchScrollingProducts() {
            if (!window.db) return setTimeout(fetchScrollingProducts, 1000);
            const container = document.getElementById('scrolling-products');
            
            window.db.collection("products").limit(10).get().then((snap) => {
                let itemsHtml = '';
                snap.forEach(doc => {
                    const p = doc.data();
                    let imgTag = p.image && p.image.startsWith('http') 
                        ? `<img src="${p.image}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">`
                        : `<i class="fa-solid fa-box-open text-3xl text-gray-300"></i>`;
                    
                    itemsHtml += `
                    <div class="w-[140px] h-[200px] shrink-0 bg-white rounded-xl border border-gray-200 p-2 flex flex-col shadow-sm group relative overflow-hidden">
                        
                        <div class="w-full h-28 bg-gray-50 rounded-lg mb-2 overflow-hidden flex items-center justify-center border border-gray-100 shrink-0">
                            ${imgTag}
                        </div>
                        
                        <div class="flex-1 flex flex-col justify-between min-h-0">
                            
                            <div class="text-[10px] text-gray-700 leading-snug" 
                                 style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                ${p.name || 'สินค้า'}
                            </div>

                            <div class="text-sm font-bold text-[#DC2626] mt-1">
                                ฿${parseFloat(p.price || 0).toLocaleString()}
                            </div>
                        </div>
                    </div>`;
                });

                if(itemsHtml) {
                    container.innerHTML = itemsHtml + itemsHtml; 
                } else {
                    container.innerHTML = '<div class="w-full text-center text-xs p-4" data-i18n="no_products">ไม่มีสินค้า</div>';
                    container.style.animation = 'none';
                }
            });
        }
        fetchScrollingProducts();
    </script>
</body>
</html>